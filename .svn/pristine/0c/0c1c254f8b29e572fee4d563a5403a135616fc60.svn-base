extends ../layout

block body
	br
	div.row
		div.col-lg-4
			div.panel.panel-primary
				div.panel-heading Speicherverwaltung
				table.table.table-striped
					tr
						th Anzahl der Bilder
						td #{picCount}
					tr
						th Anzahl der Videos
						td #{videoCount}
					tr
						th Verwendeter Speicherplatz
						td #{usedMemory} MB
					tr
						th Noch verfügbarer Speicherplatz
						td 2000 MB
					tr
						th Fotos sichern
						td
							button(type="button", onclick="startBackupPhoto()") speichern
					tr
						th Videos sichern
						td
							button(type="button", onclick="startBackupVideo()") speichern
		div.col-lg-4
			div.panel.panel-primary
				div.panel-heading Bewegungserkennung
				table.table.table-striped
					tr
						th Ein-/Ausschalten
						td
							div.btn-group
								button(id="detectionOn", type="button", class=(detectionState)?'btn-success active':'btn-default', onclick="toggleDetection()").btn Ein
								button(id="detectionOff",type="button", class=(!detectionState)?'btn-danger active':'btn-default', onclick="toggleDetection()").btn Aus
					tr
						th Auflösung
						td #{resolution}
					tr
						th Threshold
						td #{threshold}
		div.col-lg-4
			div.panel.panel-success
				div.panel-heading Raspberry Pi Status
				table.table.table-striped
					tr
						th Temperatur
						td #{temp}

	script(type='text/javascript').
		var detectionState = #{detectionState};
		function toggleDetection() {
			var detectionString = ''
			if(detectionState) {
				document.getElementById('detectionOn').className = 'btn btn-default';
				document.getElementById('detectionOff').className = 'btn btn-danger active';
				detectionString = '0';
			}else{
				document.getElementById('detectionOn').className = 'btn btn-success active';
				document.getElementById('detectionOff').className = 'btn btn-default';
				detectionString = '1';
			}
			detectionState = !detectionState
			var xmlhttp;
			if (window.XMLHttpRequest){
				// code for IE7+, Firefox, Chrome, Opera, Safari
				xmlhttp=new XMLHttpRequest();
			}
			else{
				// code for IE6, IE5
				xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			}
			xmlhttp.open("GET","/settings/toggleDetectionState/"+detectionString, true);
			xmlhttp.send();
		}
		function startBackupPhoto() {
			var xmlhttp;
			if (window.XMLHttpRequest){
				// code for IE7+, Firefox, Chrome, Opera, Safari
				xmlhttp=new XMLHttpRequest();
			}
			else{
				// code for IE6, IE5
				xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			}
			xmlhttp.open("GET","/backup/photo", true);
			xmlhttp.send();
		}
		function startBackupVideo() {
			var xmlhttp;
			if (window.XMLHttpRequest){
				// code for IE7+, Firefox, Chrome, Opera, Safari
				xmlhttp=new XMLHttpRequest();
			}
			else{
				// code for IE6, IE5
				xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
			}
			xmlhttp.open("GET","/backup/video", true);
			xmlhttp.send();
		}